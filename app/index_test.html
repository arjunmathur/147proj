<!DOCTYPE html>
<html>
	<head>
		<title>SocialGPS</title>
		<meta charset="utf-8">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="viewport" content="width=device-width, initial-scale=1"> 
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
		<link rel="apple-touch-startup-image" href="startup.png">
		<link rel="stylesheet" href="gmaps.css" type='text/css'/>
		<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
		<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
  		
	</head>	
	
	<body>
		<div data-role="page" data-theme="a" id="home" style="width:100%; height:100%;">
			<div data-role="header">
				<a href="settings.html" data-icon="gear" >Settings</a>
				<h1>GrouPS</h1>
				<a href="addContacts.html" data-icon="arrow-r" class="ui-btn-right">Add Friends</a>
			</div>
			
			<div data-role="content" style="width:100%; height:100%; padding:0;"> 

				<section id="wrapper" style="width:100%; height:100%;">
					<label for="searchbar"></label>
					<input type="search" name="searchbar" id="searchbar" placeholder=" Address or Destination" value=""  />
					
					<article>
					  <p><span id="status">Locating...</span></p>
					  <div id="map"></div>
					</article>
					<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
  					<script type="text/javascript" src="https://raw.github.com/HPNeo/gmaps/master/gmaps.js"></script>
					<script type="text/javascript">
						var service; var map; var searchBox; var latlng; var markersArray = [];
						
						/* On page load, get geolocation and create map */
						$(document).bind('pageinit',function(event){
						  if (navigator.geolocation) {
							navigator.geolocation.getCurrentPosition(success, error);
							} else {
							error('not supported');
						}
						});
						
						/* On search enter, search for places and put markers */
						$("#searchbar").live("change", function(event, ui) {
							search();
							});
							
						
						
						
						function success(position) {
						  
						  $('#status').html("");
						  
						 var mapcanvas = document.createElement('div');
						  mapcanvas.id = 'mapcanvas';
						  mapcanvas.style.height = '300px'; //TODO: how to make 100%
						  mapcanvas.style.width = '320px';
							
						  $('article').append(mapcanvas);
						  
						  map = new GMaps({
        				   div: '#mapcanvas',
       					   lat: position.coords.latitude,
      					   lng: position.coords.longitude
     					  });
						}
						
					
						function error(msg) {
						  var s = document.querySelector('#status');
						  s.innerHTML = typeof msg == 'string' ? msg : "failed";
						  s.className = 'fail';
						}
						
						
					</script>
				</section>	
			</div>
		</div>
	</body>
</html>